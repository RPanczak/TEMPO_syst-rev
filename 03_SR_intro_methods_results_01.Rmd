---
title: "Estimating temporary populations: a systematic review of the empirical literature"
author: "Radoslaw Panczak, Elin Charles-Edwards, Jonathan Corcoran"
# date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  word_document:
    fig_caption: yes
    toc: yes
    # reference_docx: template.docx
link-citations: yes
csl: bibliography/demographic-research.csl
bibliography:
- bibliography/Temporary Populations.bib
- bibliography/Extras.bib
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(pacman)
p_load(tidyverse, readxl, knitr, sjmisc, sjPlot, scales)

```

```{r data, include=FALSE}
main <- read_excel("./data/TEMPO_SR_2019-06-01.xlsx", sheet = "Main") %>% 
  replace(is.na(.), "") %>% 
  select(-Peer_review, -Theory, -Data_base, -Est_start, -Est_end) %>% 
  mutate(Est_pop_size = as.numeric(Est_pop_size)) %>%
  mutate(Data_size_users = as.numeric(Data_size_users)) %>% 
  mutate(Data_size_users = as.numeric(Data_size_activities)) %>% 
  mutate(Year_pub = as.numeric(Year_pub)) %>% 
  mutate(Est_tunit_num = as.numeric(Est_tunit_num)) %>% 
  mutate(Est_spat_num_1 = as.numeric(Est_spat_num_1)) %>% 
  mutate(Est_spat_num_2 = as.numeric(Est_spat_num_2))
# View(main)

```


# Background

Conventional population estimates capture a population at a single point in time. Such estimates ignore the short-term dynamism of many populations caused by temporary population mobility, territorial movement which does not result in a permanent change of usual residence [@bellComparingTemporaryMobility2000]. Temporary population movements are defined as moves of one or more night’s duration, but can be broadened to include diurnal movements such as daily commuting [@smithMethodologyEstimatingTemporary1989]. Temporary mobility can have a large impact on the size and composition of small area populations [@charles-edwardsElsewhereAustraliaSnapshot2018] impacting traffic, housing, retail sales, medical services and emergency preparedness to name a select few  [@smithMethodologyEstimatingTemporary1989; @smithTemporaryMigrationCase2007]. As a consequence, there is growing interest and need for temporary population estimates across a broad range of purposes including the planning and delivery of goods and services, fiscal equalisation [@graebertNorthwestMichiganSeasonal2014], retail analysis, transport demand, emergency preparedness, and as better denominators for crime and epidemiological models [@charles-edwardsFrameworkOfficialTemporary].

Scholarship concerned with developing the conceptual aspects of temporary populations has seen a longstanding interest with early work appearing in the Unites States in the 1950s [@foleyUrbanDaytimePopulation1954; @schmittEstimatingDaytimePopulations1956]. This early work proposed building on traditional demographic approaches to generate temporary population estimates and was first to recognise the potential value of symptomatic data as a source for such statistics. Several decades later it was Smith [-@smithHowTallyTemporary1987; -@smithMethodologyEstimatingTemporary1989] that proposed set of metrics (visitor-days and visitor-years) to capture measures of population present as well as highlighting the difficulty of validating estimates of temporary populations. More recently, Bell [@bellDataTheoryMethod2000; @bellMeasuringTemporaryMobility2004] argued that estimates of temporary populations are contingent on developing a rigorous understanding of temporary population mobility. Here he drew attention to four dimensions (movement intensity, duration, seasonality and spatial impact) which he argued are associated with temporary mobility and that drive the change in stock of temporary visitors at both the origin and at the destination.

Despite growing interest in temporary population statistics, they still do not form part of the standard suite of any official population statistics. Historically, this been due to a lack of data capturing temporary populations, but also nascent conceptualisation of temporary populations and lack of standard methodologies for their production. Indeed, Smith [-@smithMethodologyEstimatingTemporary1989], in his seminal paper on the estimation of temporary populations, noted that the development of a methodology applicable across a wide range of population and scenarios was ‘most likely impossible’. He could not have predicted the proliferation of geo-located data from mobile phones and other technologies in the 21st Century with potential for the sensing of temporary populations across large geographic areas and in widely differing contexts. The current study assesses progress in the field of temporary population statistics. To this end, we conduct a mixed method review of the international literature on the estimation of temporary populations to identify the contemporary state of the art. To this end the study seeks to understand the volume, geography, population coverage along with the data and methods used to generate temporary population estimates, and investigate how such estimates might be reconciled alongside traditional population statistics. 

The remainder of the paper is structured as follows: In Section 2 we detail the adopted methods including information sources and search terms, eligibility criteria and data extraction. In Section 3, we report results of the review examining both theoretical and applied work. In the final sections of the paper we summarise the current start of the art and make a series of recommendations for the production of temporary population statistics.


# Methods: Protocol and capture

The review was conducted using the principles of the PRISMA Statement for Reporting Systematic Reviews [@moherPreferredReportingItems2009]. In order to deal with complexity and lack of standarization in the field and to account for theory-building character of this work we additionally adopted "mixed-method review" methodology [@goughQualitativeMixedMethods2015]. That allowed us to combine methods of a systematic review (selection of keywords and sources, eligibility criteria, etc.) with the openness and flexibility of traditional reviews.

Articles that form the basis of the review were captured via search of four databases; (1) Web of Science; (2) Scopus; (3) Google Scholar; and, (4) arXiv. All databases were searched using a set of keywords that collectively encompass the breadth of synonyms for temporary populations. More specifically we employed a suite of terms that were derived from the authors existing knowledge of the field, as well as key terms that emerged during early stages of the review process. Terms included: “temporary population”, “working population”, “daytime population”, “mobile population”, “service population”, “floating population”, “elusive population”, “ambient population”, “seasonal population”, “non-resident population”, “real-time census”, “social sensing” and “spatiotemporal population”. We additionally scrutinised the reference lists of included studies to ensure full coverage of articles. Last searches were conducted on the 24 November 2017. In order to to enhance the currency and coverage of the articles captured we adopted some of the principles of living systematic review methodology [@elliottLivingSystematicReviews2014]. We set up and reviewed updates from three of the databases covering all queries, and manually searched the fourth one. The final inclusion of studies into the review was conducted on `r format(Sys.time(), '%d %B %Y')`. _Appendix 1_ contains details of the search strategy.

To supplement the key search terms listed above, inclusion and exclusion criteria were developed. These included:

- Studies were excluded if they focused their analyses on certain population bases (for instance, social media or mobile phone users) without any extrapolation to the total population of a region. 
- Studies were required to detail their methodology for at least one geographical region and capture non-resident populations. 
- Studies estimating tourist arrivals and crowds were also excluded given that our interest here is one to establish more complete and stable populations in the areas in contrast to subgroups (such as tourists) or highly transient populations (such as crowds or pedestrians).

- Studies were included if they produced estimates or forecasts of temporary populations.

- Book reviews and magazines were excluded. 

- Only studies published in English were included. 

These criteria were designed to capture studies that offered in-depth empirical analysis of temporary population estimation rather than either theoretic development/debate or studies that presented descriptive analyses. Beyond the aforementioned criteria, there were no restrictions based on publication date, or publication status (for example, a published article versus an unpublished thesis). In cases where the same or similar methodology was used in several studies we selected one representative article to present in the review and collected further references in supplementary materials. 

Information extracted from the studies was split into two major groups and included (_Appendix 2_):

1. Publication details: Publication metadata included: authors, title, source, year and publication type. We classified studies according to the primary source of data: mobile phones (MP), remote sensing (RS), social media (SM), transport (e.g. cordon counts, traffic and smart card data), administrative data (e.g. national censuses, health care records or various registries such as a registry of second homes), surveys (e.g. time use survey, holiday accommodation occupancy surveys), Wi-Fi and data from utility providers (e.g. electricity consumption). Studies could belong to more than one category.

2. Estimation: characteristics of estimates in the study including whether estimates captured daytime or overnight populations, the country and region for which estimates were made, data sources, methods and software, data and population size, number of spatial and temporal units, validation of estimates and the purpose for which they were produced. 


# Results and Discussion: Estimating temporary populations

```{r eval=FALSE, include=FALSE}
nrow(main)
frq(main$Source)
```


Collectively, our initial search strategy initially identified around 28 thousands documents. After removing duplicates, titles and abstracts were screen for eligibility resulting in the set of 122 articles. The final stage involved a screening of full texts resulting in the removal of a further 69 articles. Additional `r nrow(filter(main, Source == "manual"))` articles were identified from other sources and `r nrow(filter(main, Source == "update"))` - captured by scaning updates of the search results. A total of `r nrow(main)` studies were taken forward to form part of the analysis (_Appendix 2_). Figure 1 summarises the results of the search.

**Figure 1.** Flowchart of study selection. 

![](./figures/flow_chart.png)

The `r nrow(main)` studies were published between `r number(min(main$Year_pub, na.rm = TRUE), big.mark = "")` and `r number(max(main$Year_pub, na.rm = TRUE), big.mark = "")` (median publication year `r number(median(main$Year_pub, na.rm = TRUE), big.mark = "")`) and focused on various aspects of temporary population estimation, including the production of temporary population statistics (Table 1; _Appendix 2_). There has been exponential growth in the number of studies since the first in 1925, with more than third of the studies (`r format(round(100 * nrow(filter(main, Year_pub >= 2015)) / nrow(main), 1), nsmall = 1)`%) published since 2015. A total of `r percent(nrow(filter(main, Pub_type == "article"))/nrow(main))` of studies were published as articles followed by `r percent(nrow(filter(main, Pub_type == "report"))/nrow(main))` as reports and `r percent(nrow(filter(main, Pub_type == "conference"))/nrow(main))` as conference proceedings or presentations.

```{r eval=FALSE, include=FALSE}
main %>% 
  select(starts_with("Purpose_")) %>% 
  gather(key, count, Purpose_1:Purpose_2) %>% 
  filter(count != "") %>% 
  frq(count, sort.frq = c("desc"))
```

**BROADER TRANSPORT CATEGORY???**

The following discussion draws on the content of the included papers that are cited throughout the text as required. Emergency planning (n=`r nrow(filter(main, Purpose_1 == "emergency planning" | Purpose_2 == "emergency planning"))`) was the most frequently quoted as reason for producing temporary population estimates followed by understanding service populations (n=`r nrow(filter(main, Purpose_1 == "service population" | Purpose_2 == "service population"))`), epidemiology (n=`r nrow(filter(main, Purpose_1 == "epidemiology" | Purpose_2 == "epidemiology"))`) and commuting (n=`r nrow(filter(main, Purpose_1 == "commuting" | Purpose_2 == "commuting"))`), many studies directly discussing a domain of application. We next discuss the papers under 6 broad domains; (1) data; (2) methods; (3) the geography of estimates; (4) temporal units; (5) population size and composition; and, (6) reproducibility.

## Data

```{r eval=FALSE, include=FALSE}
main %>% 
  select(Year_pub, starts_with("Type_"), -Type_other) %>% 
  gather(Order, Type, Type_1:Type_3) %>% 
  filter(Type != "") %>% 
  frq(Type, sort.frq = c("desc"))
```

Administrative data, defined as **XXXXX** , formed the basis or were the strong component of the largest number of studies (Figure 2). First report was based on the 1921 Census data from England and Wales and used data on place of work to estimate daytime population [@censusofenglandandwales1921Workplaces1925]. These estimates continue to be delivered with the latest Census also offering workday population estimates for England and Wales [@officefornationalstatistics2011CensusWorkday2013; see also related work in _Appendix 4_]. Census data from the United Kingdom were also extensively used as a part of methodologies developed by more recent work of [@smithNationalPopulationData2005] and [@martinDevelopingFlexibleFramework2015].


```{r figure_2, fig.height=3.675, fig.width=4.9, warning=FALSE}
main %>% select(Year_pub, starts_with("Type_")) %>% 
  mutate(denominator = rowSums(!is.na(select(., -Year_pub)))) %>% 
  gather(Order, Type, Type_1:Type_4) %>% 
  filter(Type != "") %>% 
  filter(Type != "SM") %>% # count of 1 so no line possible
  mutate(weight = 1/denominator) %>% 
  select(-Order, -denominator) %>% 
  arrange(Type, Year_pub) %>% 
  group_by(Type) %>% 
  mutate(cumulative = cumsum(weight)) %>% 
  ggplot(aes(Year_pub, cumulative, colour = Type)) + 
  geom_line() +
  scale_fill_brewer(palette = "Set3") +
  theme_minimal() + 
  labs(x = "Year of publication",
       y = "Number of studies")
```


**Figure 2.** Cumulative distribution of year of publication across main themes. Note: Studies belonging to more than one category were weighted by dividing all categories by 1 and assigning equal weights. This procedure excludes the Social Media (SM) category as it only has one member. 

```{r figure_2_alt, eval=FALSE, fig.height=3.675, fig.width=4.9, warning=FALSE}
main %>% select(Year_pub, starts_with("Type_")) %>% 
  gather(Order, Type, Type_1:Type_4) %>% 
  filter(Type != "") %>% 
  filter(Type != "SM") %>% # count of 1 so no line possible
  select(-Order, -Type_other) %>% 
  arrange(Type, Year_pub) %>% 
  group_by(Type, Year_pub) %>% 
  mutate(count = n()) %>% 
  group_by(Type) %>% 
  mutate(cumulative = cumsum(count)) %>% 
  ggplot(aes(Year_pub, cumulative, colour = Type)) + 
  geom_line() +
  scale_fill_brewer(palette = "Set3") +
  theme_minimal() + 
  labs(x = "Year of publication",
       y = "Number of studies")
```

The equivalent of this work in the United States employ commuter-adjusted population estimates using the American Community Survey to adjust night-time population counts [@mckenzieCommuteradjustedPopulationEstimates2013]. Other primarily Census-based studies from the United States include the work from the Seattle City Planning Commission [-@seattlecityplanningcommissionDaytimeNighttimePopulation1951] and Bureau of the Census [-@bureauofthecensusPopulationEstimatesSurvival1956], @fultonEstimatingDaytimePopulation1984, @goberGeographyNonpermanentResidence1984, @nelsonEstimatingFunctionalPopulation1992, @mcphersonDayNightPopulation2003, @kobayashiVisualizingDiurnalPopulation2011, @swansonEstimatingFactoPopulation2011, @hodurServicePopulationEstimates2015, @kimModellingDaytimePopulation2017, @boeingEstimatingLocalDaytime2018 and @esriMethodologyStatement20182018. Each used a wide selection of methods to adjust Census estimates on variety of scales, often accompanied by other data sources. This for example includes, location of work, transportation models or payroll data that helps to determine size and location of daytime or seasonal population.  

Census data were also used for estimation and analyses of temporary populations in Australia. Taking advantage of the availability of the place of residence and place of enumeration @bellPatternsTemporaryMobility1998 (see also subsequent work in _Appendix 4_) looked at the one day snapshot of mobility of Australians across different years and scales whereas @taylorMeasuringShortTerm1998 used Census for the estimation of mobility of indigenous people. Finally @gaoAssessingSocialEconomic2014 used Chinese Census data adjusted with figures for tourists, school and patient populations and @qiModelingSpatialDistribution2015 extended it with land use models.

Census main advantage is that it provides close to full enumeration of the population, however it also provides only a snapshot of temporary populations on one day or night, every five or ten years. Many form of temporary population mobility are highly seasonal, thus census data will not reflect the population present at other times of the year. Finally, other forms of administrative data such as health service utilization records [@markhamNewDirectionsIndigenous2013], building [@gregerSpatioTemporalBuildingPopulation2015] or second home registries [@adamiakSeasonalResidenceCounterurbanization2017] often complement census providing another data source for methods estimating temporary populations. 

The second most frequent group of studies was based on data coming from wide array of surveys. The early work from United States can be traced back to the work of Thornthwaite who estimated daytime population of a Central Business District using **XXXXX** [-@thornthwaiteLouisvilleKentuckyStudy1929; cited in @wheelerUrbanGeographerHis2002]. Others followed including Breese [-@breeseDaytimePopulationCentral1947], Sharp [-@sharpNonResidentialPopulationCentral1955] and Weir [-@weirSurveyDaytimePopulation1960]. The New York Regional Plan Association [-@newyorkregionalplanassociationPersonsVehiclesEntering1949], Seattle City Planning Commission [-@seattlecityplanningcommissionDaytimeNighttimePopulation1951] and Institute for Research in Social Science at the University of North Carolina [-@instituteforresearchinsocialscienceuniversityofnorthcarolinaPopulationDistributionSpatial1952] employed **XXXXX** to do **XXXXX**. Similar work from UK was done by Menzler [-@menzlerEstimateDaytimePopulation1952]. All these early effort relied on relatively simple methods and working with various survey data, often transport related (cordon counts, traffic surveys) but sometimes surveying whole resort town [@ericksonMeasuringResortPopulation1961] or areas with significant concentrations of temporary residents [@happelCountingSnowbirdsImportance2002]. Many of these conceptual approaches have been updated and developed further with various other types of surveys including travel surveys in multiple locations [@wurtelePopulationDynamicsFinal1968, @kavanaughMethodEstimatingDaytime1990; @stutzChartingUrbanSpacetime1992; @roddisMetropolitanActivityProfiles1996; @collinsDaytimePopulationTracking2007; @lauGISBasedStochastic2009; @horanontEstimateAmbientPopulation2010; @charles-edwardsModellingFluxEstimation2011; @sekimotoPFlowReconstructingPeople2011; @himotoModelSpatiotemporalDistribution2014; @kashiyamaOpenPFLOWCreation2017] as well as more traditional, telephone surveys [@galvezMeasurementFloridaTemporary1996] or specific surveys such as counts of indigenous population [@warchivkerTurmoilAboriginalEnumeration2000], all complimenting data sources for estimation of temporary populations.

Although censuses and surveys tend to lose their position as primary source of data, they still remain crucial part of many estimation attempts. There is a shift from using them as primary sources and into providing more complimentary role, for instance serving as starting points for estimation (–for example,  serving as ‘night time population’), delivering time use profiles used to redistribute other data or calibrate models or as a source of validation. For instance, seminal work of LandScan [@bhaduriLandScanUSAHighresolution2007] used Census as one of the main inputs and @maModelingHourlyDistribution2017 used smart card data to redistribute census (night) counts of population across city.

Third largest category of studies, and one that experienced the fastest growth in recent years, is work based on mobile phone (MP) data. The earliest identified application of MP data to estimate temporary populations was done in response to Haiti earthquake [@bengtssonImprovedResponseDisasters2011]. That was quickly followed by large scale estimates for Japan [@teradaPopulationEstimationTechnology2013] and analyses of temporary populations in France and Portugal [@devilleDynamicPopulationMapping2014]. Spatial coverage of MP based studies often reflects availability and accessibility of data. For instance, Italy and in particular Milan, are the subject of a number of studies due to the fact that local providers offer access to the aggregated and anonymized call detail records (CDR) or other data such as **XXXXX** [@khodabandelouPopulationEstimationMobile2016; @khodabandelouEstimationStaticDynamic2018]. MP data are also used in parallel with other sources and methods for instance in dasymetric interpolation [@jarvEnhancingSpatialAccuracy2017] or together with transport survey data [@lwinSpaceTimeMultiple2016].


Less common, yet still significant are studies were based on utilities data [@goldschmidtDemoflushEstimatingPopulation1976; @monmouthcountyplanningboardSummerCoastalPopulation2008; @rigall-i-torrentEstimatingOvernightFacto2010; @mckenzieDemographicsFireRisk2016; @edmondsonMakingItCount], remote sensing [@taubenbockLinkingStructuralUrban2007; @stathakisSeasonalPopulationEstimates2018] and Wi-Fi [@kontokostaUrbanPhenologyRealtime2017]. Contrary to our expectations, social media (SM) data were only used by one study [@lwinSpaceTimeMultiple2016].

**ADD CROLLS 2019 TO WIFI**

Recognition of complexity of providing estimates together with growing availability of data also led to attempts combining multiple sources of data [@fehrpeersNapaCountyTravel2014, @edmondsonMakingItCount].

**FIX NANTUCKET DATE TO 219?**

### Main trends in methods

**MOVE TO MEHODS SECTION?**
Approaches based on dasymetric methods form another important strand of work. Apart from census [@bhaduriLandScanUSAHighresolution2007, @martinDevelopingFlexibleFramework2015] and MP [@jarvEnhancingSpatialAccuracy2017] based studies mentioned above, four more studies used this approach redistributing nighttime populations using ancillary statistics and locations of working populations [@sleeterEstimatingDaytimeNighttime2006; @freireModelingSpatiotemporalDistribution2010], building characteristics [@gregerSpatioTemporalBuildingPopulation2015] or land use [@batistaesilvaSpatiotemporalMappingPopulation2017].
**MOVE TO MEHODS SECTION?**

The earliest and most straightforward method of deriving temporary populations was to use direct estimates, either from the Census [@censusofenglandandwales1921Workplaces1925], survey [@thornthwaiteLouisvilleKentuckyStudy1929] or by combining multiple sources [@breeseDaytimePopulationCentral1947]. These studies took advantage of availability of information about workplaces of individuals [@officefornationalstatistics2011CensusWorkday2013], their status of residence [@goberGeographyNonpermanentResidence1984] or place of enumeration [@bellPatternsTemporaryMobility1998] to distinguish between two or more states of population distribution such as night- and daytime. 

Alternative approaches used some form of scaling of population counts derived from one or several sources to the whole population either by single or multiple factors. Such approaches were used by both early surveys [@newyorkregionalplanassociationPersonsVehiclesEntering1949; @foleyDailyMovementPopulation1952] and more contemporary analyses based on MP or Wi-Fi data. In the latter case, various strategies of expansion factors were adopted, some based on penetration rate of MP data provider [@bengtssonImprovedResponseDisasters2011], night-time Census population [@devilleDynamicPopulationMapping2014] or ancillary survey data [@kontokostaUrbanPhenologyRealtime2017]. Studies either used single factor for entire region [@thomasUseMobileDevice2017] or multiple ones, varying them geographically [@batranInferencingHumanSpatiotemporal2018] or over subgroups of population [@picornellPopulationDynamicsBased2018]. 

Separate strand of research focused on various method of redistribution of one or more sources of data available for larger spatial units to smaller ones. Such approaches used various methods, often mimicking dasymetric approaches used for non-temporary population mapping. LandScan USA [@bhaduriLandScanUSAHighresolution2007] is an example of such project with largest spatial coverage for instance whereas Martin et al. [-@martinDevelopingFlexibleFramework2015] model for Southampton is an example of more spatially and temporally detailed approach. Redistribution approach usually uses some ancillary data such as land use [@batistaesilvaSpatiotemporalMappingPopulation2017] or building type [@gregerSpatioTemporalBuildingPopulation2015] and apart from Census or surveys could also use MP [@jarvEnhancingSpatialAccuracy2017] or transportation data [@maModelingHourlyDistribution2017] as input. 

Temporary populations were also estimated using various equation-based techniques. These methods used generic or area-specific equation to derive counts of temporary residents from usual residents subtracting departures and adding arrivals to a spatial unit in given time [@yongliResearchStatisticalModels1998]. For instance JTW data could be used to capture working population [@mckenzieCommuteradjustedPopulationEstimates2013], second home users and usage could be used to capture seasonal populations in specific areas [@adamiakSeasonalResidenceCounterurbanization2017] or sales tax data could be used to derive equivalent residents [@thakurMethodologyAccountSeasonal2018]. Additionally, separate estimates could be derived for subgroups of population [@swansonEstimatingFactoPopulation2011] or for temporal units using seasonal coefficient derived from night-time satellite imagery [@stathakisSeasonalPopulationEstimates2018].

Finally, large number of modelling and simulation approaches were tested more recently with various forms of data inputs. That ranged from agent based simulation [@walkerAgentbasedPopulationModel2012; @kashiyamaOpenPFLOWCreation2017], cellular automaton model [@khakpourAttractionbasedCellularAutomaton2016], to the use of neural networks [@chenFinegrainedPredictionUrban2018; @liuMappingHourlyDynamics2018] 

### Captured populations

Majority of studies focused on general populations - either overall or restricted to working population. Such focus was often driven not by the theoretical or practical considerations but rather by availability of the data. For instance many studies based on MP data do not have access to any information on the users. 

Examples of specific segments of population captured by the studies include retired individuals [@roseSeasonalMigrationRetired1989], snowbirds [@happelCountingSnowbirdsImportance2002], pupils [@campbellDevelopingExtensibleSolution2010], summer resort population [@ericksonMeasuringResortPopulation1961; @goldschmidtDemoflushEstimatingPopulation1976], second home users [@adamiakSeasonalResidenceCounterurbanization2017] or indigenous population [@warchivkerTurmoilAboriginalEnumeration2000]. Focus on specific population might also be a result of focusing on functional area such as university campus [@charles-edwardsEstimatingServicePopulation2013]. 

### National coverage & geographical breakdown

Only `r percent(nrow(filter(main, National == "yes"))/nrow(main))` of studies reported on estimates created for the whole country. USA was the most represented with five studies, followed by Australia and England & Wales. Only one developing country [Nepal, @wilsonRapidRealTimeAssessments2016] was represented and one study reported on two countries [@devilleDynamicPopulationMapping2014]. Studies covering only part of the coutry were again most frequent in USA. That was followed by China, Austrlia, Japan and UK. A handful of developing nations were included as well. Slightly more than half of the studies were focused on a single city. 

```{r, eval=FALSE}
main %>% 
  mutate(Region_type = ifelse(National == "yes", "country", Region_type)) %>%
  frq(Region_type, sort.frq = "desc")
```

```{r}
main %>% select(National, starts_with("Country_")) %>% 
  gather(Order, Country, Country_1:Country_2) %>% 
  filter(Country != "") %>% 
  ggplot(aes(fct_infreq(Country))) +
  geom_bar() + 
  coord_flip() +
  facet_wrap(~ National) +
  theme_minimal() + 
  labs(x = "",
       y = "Number of studies",
       title = "Country of estimates & national coverage",
       caption = "Study can describe more than one country.")

```

**TODO:** could be a map?

### Spatial unit of estimates

Two types of units dominated estimates: `r percent(nrow(filter(main, Est_unit_type_1 == "admin" | Est_unit_type_2 == "admin" ))/nrow(main))` studies used some form of administrative units and `r percent(nrow(filter(main, Est_unit_type_1 == "grid" | Est_unit_type_2 == "grid" ))/nrow(main))` various size of regular grid tessalating area of interest. Other type of unts ranged from whole city to individual points, nodes or Vornoi polygons.Note that studies could report on more than one type of units. 

```{r, eval=FALSE}
main %>% 
  select(starts_with("Est_unit_type_")) %>% 
  gather(Order, Sunit, Est_unit_type_1:Est_unit_type_2) %>% 
  filter(Sunit != "") %>% 
  frq(Sunit, sort.frq = "desc")
```

### Number of spatial units

There was a great variation in the number of spatial units used to produce estimates ranging from `r number(min(main$Est_spat_num_1, na.rm = TRUE))` to `r number(max(main$Est_spat_num_1, na.rm = TRUE), big.mark = ",")`
with median value of `r number(median(main$Est_spat_num_1, na.rm = TRUE), big.mark = ",")`. `r number(nrow(filter(main, Est_spat_num_1 == 1)))` studies reported on single spatial unit of various size such as island [@edmondsonMakingItCount], administrative region [@fehrpeersNapaCountyTravel2014], city [@goldschmidtDemoflushEstimatingPopulation1976] or campus [@charles-edwardsEstimatingServicePopulation2013]. Studies reporting on larger amount of units provided estimates on building level [@araImpactTemporalPopulation2014] or used high resolution grids [@adamiakSeasonalResidenceCounterurbanization2017] or administrative areas [@mckenzieCommuteradjustedPopulationEstimates2013], often with national or large-area coverage. `r number(nrow(filter(main, is.na(Est_spat_num_1))))` studies did not report exact number of spatial units. 

```{r, eval=FALSE}
descr(main, Est_spat_num_1)
```

### Daytime & temporal unit of estimates

Majority of studies (`r percent(nrow(filter(main, Day == "yes"))/nrow(main))`) reported on daytime populations. That has been reflected in the choice of the temporal units of the estimates - `r percent(nrow(filter(main, Est_tunit == "minute/hour"))/nrow(main))` of studies used minutes or hours as time scale. The second most common unit was split between daytime and nightime estimates (`r percent(nrow(filter(main, Est_tunit == "daytime/nighttime"))/nrow(main))`) or only daytime (`r percent(nrow(filter(main, Est_tunit == "daytime"))/nrow(main))`). 

```{r eval=FALSE}
main %>% 
  filter(Est_tunit != "") %>% 
  filter(Day != "") %>% 
  ggplot(aes(fct_infreq(Est_tunit))) +
  geom_bar() + 
  coord_flip() +
  theme_minimal() + 
  labs(x = "",
       y = "Number of studies",
       title = "Type of temporal units used vs. daytime",
       caption = "Study can use than one time unit.") +
  facet_wrap(~ Day) 
```

```{r}
main %>% 
  filter(Est_tunit != "") %>% 
  filter(Day != "") %>% 
  ggplot(aes(fct_infreq(Est_tunit))) +
  geom_bar() + 
  coord_flip() +
  theme_minimal() + 
  labs(x = "",
       y = "Number of studies",
       title = "Type of temporal units used",
       caption = "Study can use than one time unit.")
```


### Estimated population size 

There was a great variation in the size of estimated populations, ranging from `r number(min(main$Est_pop_size, na.rm = TRUE))` to `r number(max(main$Est_pop_size, na.rm = TRUE), big.mark = ",")`
with median value of `r number(median(main$Est_pop_size, na.rm = TRUE), big.mark = ",")`. When the size of dataset was taken into account these figures ranged from `r number(min(main$Data_size_users, na.rm = TRUE))` to `r number(max(main$Data_size_users, na.rm = TRUE), big.mark = ",")`
with median value of `r number(median(main$Data_size_users, na.rm = TRUE), big.mark = ",")`. Combining these two sources of information, largest populations were used or estimated when MP data were used, followed by smaller amount of transport-based studies. Other large studies used various forms of tax data. 


```{r eval=FALSE}
descr(main, Est_pop_size)
descr(main, Data_size_users)
```

```{r}
main %>%
  mutate(Est_pop_size = ifelse(test = (is.na(Est_pop_size) & !is.na(Data_size_users)), 
                               yes = Data_size_users, no = Est_pop_size)) %>% 
  filter(Est_pop_size != "") %>% 
  ggplot(aes(Type_1, Est_pop_size)) + 
  geom_boxplot(varwidth = TRUE) +
  scale_y_log10() +
  theme_minimal() + 
  labs(x = "Main type of publication",
       y = "Estimated population",
       title = "Size of estimated population across main themes")
```

**Note:* Main category used. Box width proportional to number of studies. Studies that did not report on estimated population size had it replaced with size of dataset whenever possible. See main text for abbreviations of types.

### Estimates & software/code availability

```{r, eval=FALSE}
frq(main, Est_avail, sort.frq = "none")
frq(main, Software_avail, sort.frq = "none")

main %>% 
  filter(Est_avail == "") %>% 
  select(FA_surname)
```

`r percent(nrow(filter(main, Est_avail == "no"))/nrow(main))` of studies did not report estimates nor indicated any way where they could be obtained. Similarly, large ampount of studies did not report on type of software and/or code used to produce them. In some cases, particularly when relatively simple methods were used (for instance equation based) that would not limit reproducibility or replicability of the studies or possibility to implement them in different settings. However, for many studies, particularly based on proprietary data, the possibility of using the estimates in different areas or extending or validating the methods used will be seriously limited. 


### Validation

```{r, eval=FALSE}
main %>% 
  frq(Validation, sort.frq = c("desc"))
```

Similarly to the lack of estimates and software availability, the validation of the results was not a common practice. Only `r percent(nrow(filter(main, Validation == "yes"))/nrow(main))` reported on some attempt to validate results. However, even if that was attempted the results were mostly simply compared or correlated alternative measure such as nightime population distribution. Lack of data was often quoted as a main reason. 

### Purpose of study

Emergency planning was the most frequently quoted as reason for producing estimates followed by smaller amount of studies focused on service populations estimation, epidemiology and commuting.

```{r}
main %>% 
  select(starts_with("Purpose_")) %>% 
  gather(Order, Purpose, Purpose_1:Purpose_2) %>% 
  filter(Purpose != "") %>%
  frq(Purpose, sort.frq = c("desc"))
```



Important extension of this work was a report by Markham and colleagues [-@markhamNewDirectionsIndigenous2013] which discussed challenges involved in estimation of indigenous service populations.


# Conclusions

Large body of literature on similar topics that have potential overlap such as 

- estimates of overall pops (such as WorldPop [@tatemWorldPopOpenData2017a] etc.)

- MP use (without pop est) >> seminal examples like [@calabreseRealTimeRome2006] and [@silmSeasonalVariabilityPopulation2010]

- SM use (without pop est) 
- Twitter [@brogueiraUsingGeolocatedTweets2016]
- Snapchat [@juhaszAnalyzingSpatioSpatiotemporal2018]
- search engine data [@liSpatiotemporalDistributionCharacteristics2019]

- analyses focusing on mobility rather than stocks and flow estimation [@gonzalezUnderstandingIndividualHuman2008]

- tourism
- tourist arrivals - here some methods could be adapted to TEMPO for instance 
- traveler populations at transportation terminals [@jochemEstimatingTravelerPopulations2013]
- forecasting tourist volume with search engine data [@liEffectiveTouristVolume2018], Google Analytics [@gunterForecastingCityArrivals2016], Google Trends [@onderForecastingTourismDemand2017]

- crowd estimation and event monitoring 
- more classic approach at demonstrations [@yipEstimationNumberPeople2010]
- agent-based modelling [@chowCrowdsourcingGeocomputationalFramework2018]
- social media [@simsApplicationSocialMedia2017]
- bluetooth [@versicheleUseBluetoothAnalysing2012]
- MP [@mameiEstimatingAttendanceCellular2016]
- Instagram [@bottaMeasuringSizeCrowd2019]

- pedestrian movements 
- using GPS & MP [@mizziUnravelingPedestrianMobility2018]
- using Wi-Fi & Bluetooth [@bohmEvaluatingUsageWiFi2016]

- buildings occupancy [@stewartCanSocialMedia2017]

- animal & ecology studies 
- abundance [@melvilleEstimatingSpeciesAbundance2009]
- movement [@millerIntegratedScienceMovement2019]

But many of these studies never move from the analysis of user base to estimates of pop

New data such as SM offer exciting opportunities but bring with them lots of challenges both with data collection and processing [@liaoBigDataenabledSocial2018, @martiSocialMediaData2018].

Very small amount of studies provide estimates. Mention notable exceptions here... Mention synthetic data...

Very small amount of studies provide code /software used for analyses. Mention notable exceptions here...

Importance of good quality of census and survey data as a basis for other methods.

In the absence of official estimates cities and regions attempt their own calculations 
[@lambEstimatingSeasonalPopulation1999, @monmouthcountyplanningboardSummerCoastalPopulation2008, @fehrpeersNapaCountyTravel2014, @hodurServicePopulationEstimates2015, @edmondsonMakingItCount]


## Strengths

- first and only of this kind?

- up to date results

- systematizing state of the art 

- offers guidance towards future work (terminology, keywords, themes, etc.)


## Limitations

- fragmented field, lack of standards and definitions, difficult to search; `r percent(nrow(filter(main, Source == "manual"))/nrow(main))` of studies included were found outside of main searches 

- keywords overlap (ex working pop in epi; seasonal pop in ecology) 

- keyword imprecision ex floating population in Chinese lit

- lots of grey lit, for instance `r percent(nrow(filter(main, Pub_type == "report"))/nrow(main))` of studies were in form of various reports we might have missed things


## Recomendations

Temporal trends in publication counts indicate that the field is accelerating. `r percent(nrow(filter(main, Source == "update"))/nrow(main))` of studies included were found by monitoring search engine updates. That points to even more urgent need for standardizing and systematizing field.

- guideline for systematic reporting of temporary populations estimates
- using @liaoBigDataenabledSocial2018 life cycle - ideas on each stage of development (collection, compilation, analysis & communication)
- standardization of terminology & keywords
- encourage to share methodology in more detail, preferably with software/code
- encourage to share estimates, if original data not available then synthetic data following methodology


# Contribution


# Table 1

```{r}

# Year of publication
table_1 <- 
  tibble(
    Characteristic = "Year of publication", 
    Value = "", 
    `n / median` = number(median(main$Year_pub, na.rm = TRUE), big.mark = ""),
    `% / min; max` = str_c(as.character(number(min(main$Year_pub, na.rm = TRUE), big.mark = "")),
                           as.character(number(max(main$Year_pub, na.rm = TRUE), big.mark = "")),
                           sep = "; ")
  )


# region of study
temp <- main %>% 
  mutate(Region_type = ifelse(National == "yes", "country", Region_type)) %>%
  mutate(Region_type = ifelse(Region_type == "", "undefined", Region_type)) %>%
  frq(Region_type, sort.frq = "desc", show.na = FALSE)

table_1 <- rbind(table_1,
                 cbind(Characteristic = c("Study region", 
                                          cbind(rep("", length(temp[[1]]$val)-1))),
                       Value = as.character(temp[[1]]$val), 
                       `n / median` = temp[[1]]$frq, 
                       `% / min; max` = temp[[1]]$raw.prc)
)


# region of estimates
temp <- main %>% 
  select(starts_with("Est_unit_type_")) %>% 
  gather(Order, Sunit, Est_unit_type_1:Est_unit_type_2) %>% 
  filter(Sunit != "") %>% 
  frq(Sunit, sort.frq = "desc", show.na = FALSE)

table_1 <- rbind(table_1,
                 cbind(Characteristic = c("Regions for estimates*", 
                                          cbind(rep("", length(temp[[1]]$val)-1))),
                       Value = as.character(temp[[1]]$val), 
                       `n / median` = temp[[1]]$frq, 
                       `% / min; max` = temp[[1]]$raw.prc)
)


# no of regions
# descr(main, Est_spat_num_1)

table_1 <- rbind(table_1, 
                 cbind(
                   Characteristic = "Number of regions for estimates", 
                   Value = "", 
                   `n / median` = number(median(main$Est_spat_num_1, na.rm = TRUE), big.mark = ","),
                   `% / min; max` = str_c(as.character(number(min(main$Est_spat_num_1, na.rm = TRUE), big.mark = ",")),
                                          as.character(number(max(main$Est_spat_num_1, na.rm = TRUE), big.mark = ",")),
                                          sep = "; ")
                 )
)


# pop size
# descr(main, Est_pop_size)

table_1 <- rbind(table_1, 
                 cbind(
                   Characteristic = "Size of estimated population", 
                   Value = "", 
                   `n / median` = number(median(main$Est_pop_size, na.rm = TRUE), big.mark = ","),
                   `% / min; max` = str_c(as.character(number(min(main$Est_pop_size, na.rm = TRUE), big.mark = ",")),
                                          as.character(number(max(main$Est_pop_size, na.rm = TRUE), big.mark = ",")),
                                          sep = "; ")
                 )
)


# data size
# descr(main, Data_size_users)

table_1 <- rbind(table_1, 
                 cbind(
                   Characteristic = "Size of dataset", 
                   Value = "", 
                   `n / median` = number(median(main$Data_size_users, na.rm = TRUE), big.mark = ","),
                   `% / min; max` = str_c(as.character(number(min(main$Data_size_users, na.rm = TRUE), big.mark = ",")),
                                          as.character(number(max(main$Data_size_users, na.rm = TRUE), big.mark = ",")),
                                          sep = "; ")
                 )
)



```

```{r results='asis'}
table_1 %>% 
  kable() 
```



# Bibliography

<div id="refs"></div>

# Acknowledgments

We would like to thank the authors that responded to queries about details of their work: Christoph Aubrecht, Filipe Batista e Silva, Andrew Collins, Donald G. Janelle, David Martin, Chris Needham, Paola Pucci, Stanley Smith and Martijn Tennekes. 

**ADD NIK & ANDY**


